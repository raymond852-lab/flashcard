<!DOCTYPE html>
<html>
<head>
  <title>Funny Flashcards</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
      background-color: #B2EBF2; /* Light Tiffany blue background */
    }
    #landingPage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2vh;
    }
    #studyBtn, #dictateBtn, #backBtn {
      padding: 2vh 4vw;
      font-size: 5vw;
      border: none;
      border-radius: 1vh;
      background-color: #26A69A; /* Darker Tiffany blue button */
      color: white;
      cursor: pointer;
    }
    #studyBtn:hover, #dictateBtn:hover, #backBtn:hover {
      background-color: #4DD0E1; /* Lighter Tiffany blue on hover */
    }
    .card {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #40C4B4; /* Tiffany blue card */
      padding: 1vh;
      border-radius: 2vh;
      font-size: 10vw;
      line-height: 1.1;
      text-align: center;
      width: 95vw;
      height: 60vh;
      box-sizing: border-box;
      color: white;
      border: 0.5vh solid #26A69A;
      box-shadow: 0 0 1vh rgba(0, 0, 0, 0.1);
      align-items: center;
      justify-content: center;
      overflow-wrap: break-word;
    }
    .card.sentence {
      font-size: 6vw;
    }
    #nextBtn, #playBtn, #checkBtn {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      padding: 2vh 4vw;
      font-size: 4vw;
      border: none;
      border-radius: 1vh;
      background-color: #26A69A;
      color: white;
      cursor: pointer;
      display: none;
    }
    #nextBtn {
      bottom: 22vh;
    }
    #playBtn {
      bottom: 15vh;
    }
    #checkBtn {
      bottom: 8vh;
    }
    #backBtn {
      bottom: 1vh;
      display: none;
    }
    #nextBtn:hover, #playBtn:hover, #checkBtn:hover, #backBtn:hover {
      background-color: #4DD0E1;
    }
    #dictationInput {
      position: absolute;
      bottom: 29vh;
      left: 50%;
      transform: translateX(-50%);
      width: 80vw;
      padding: 1vh;
      font-size: 4vw;
      border-radius: 1vh;
      border: 0.5vh solid #26A69A;
      display: none;
    }
    #feedback {
      position: absolute;
      top: 10vh;
      left: 50%;
      transform: translateX(-50%);
      font-size: 4vw;
      color: #ffffff;
      background-color: rgba(38, 166, 154, 0.8);
      padding: 1vh 2vw;
      border-radius: 1vh;
      display: none;
    }
    #score {
      position: absolute;
      top: 5vh;
      left: 50%;
      transform: translateX(-50%);
      font-size: 4vw;
      color: #ffffff;
      background-color: rgba(38, 166, 154, 0.8);
      padding: 0.5vh 1vw;
      border-radius: 1vh;
      display: none;
    }
    @media (orientation: landscape) {
      .card {
        font-size: 8vw;
        width: 90vw;
        height: 70vh;
      }
      .card.sentence {
        font-size: 5vw;
      }
    }
    @media (max-width: 600px) {
      .card {
        font-size: 8vw;
      }
      .card.sentence {
        font-size: 4vw;
      }
      #studyBtn, #dictateBtn, #backBtn {
        font-size: 6vw;
      }
      #nextBtn {
        bottom: 25vh;
      }
      #playBtn {
        bottom: 17vh;
      }
      #checkBtn {
        bottom: 9vh;
      }
      #backBtn {
        bottom: 1vh;
      }
      #dictationInput {
        bottom: 33vh;
        font-size: 5vw;
      }
      #feedback, #score {
        font-size: 5vw;
      }
    }
  </style>
</head>
<body>
  <div id="landingPage">
    <button id="studyBtn" onclick="startStudyMode()">Study</button>
    <button id="dictateBtn" onclick="startDictateMode()">Dictate</button>
  </div>
  <div id="flashcard" class="card"></div>
  <div id="feedback"></div>
  <div id="score"></div>
  <input id="dictationInput" type="text" placeholder="Type what you hear">
  <button id="nextBtn" onclick="nextCard()">Next Card</button>
  <button id="playBtn" onclick="playPronunciation()">Play Pronunciation</button>
  <button id="checkBtn" onclick="checkAnswer()">Check Answer</button>
  <button id="backBtn" onclick="returnToLanding()">Back to Menu</button>
  <audio id="cardSound" src="https://www.soundjay.com/buttons/button-09a.mp3"></audio>
  <audio id="clapSound" src="https://www.soundjay.com/human/applause-01.mp3"></audio>

  <script>
    const words = [
      "doctor", "writer", "engineer", "lawyer",
      "chef", "farmer", "firefighter", "nurse",
      "scientist", "waiter", "pilot",
      "sleep", "into", "find", "light",
      "please", "round", "fall", "off",
      "I want to jump on the bed.",
      "We shower in the bathroom.",
      "We eat in the dining room.",
      "There is a stove in the kitchen.",
      "There are cushions in the living room.",
      "There is a cupboard next to the mirror.",
      "They are sliding on the smooth coffee table.",
      "There is a teddy bear in front of the TV.",
      "I want to write on the desk.",
      "Do you like the round bookshelf or the square bookshelf?"
    ];
    let currentIndex = 0;
    let currentMode = null;
    let correctAnswers = 0;
    let totalAttempts = 0;
    const cardSound = document.getElementById("cardSound");
    const clapSound = document.getElementById("clapSound");
    const dictationInput = document.getElementById("dictationInput");
    const feedback = document.getElementById("feedback");
    const score = document.getElementById("score");
    const flashcard = document.getElementById("flashcard");
    const nextBtn = document.getElementById("nextBtn");
    const playBtn = document.getElementById("playBtn");
    const checkBtn = document.getElementById("checkBtn");
    const backBtn = document.getElementById("backBtn");
    const landingPage = document.getElementById("landingPage");

    function showCard() {
      flashcard.textContent = words[currentIndex];
      if (words[currentIndex].includes(".")) {
        flashcard.classList.add("sentence");
      } else {
        flashcard.classList.remove("sentence");
      }
      dictationInput.value = "";
      feedback.style.display = "none";
      if (currentMode === 'study') {
        flashcard.style.display = "flex";
        dictationInput.style.display = "none";
        checkBtn.style.display = "none";
        nextBtn.style.display = "block";
        playBtn.style.display = "block";
        backBtn.style.display = "block";
        score.style.display = "none";
      } else if (currentMode === 'dictate') {
        flashcard.style.display = "none";
        dictationInput.style.display = "none";
        checkBtn.style.display = "block";
        nextBtn.style.display = "block";
        playBtn.style.display = "block";
        backBtn.style.display = "block";
        score.style.display = "block";
        score.textContent = `Score: ${correctAnswers}/${totalAttempts}`;
        playPronunciation(); // Auto-play in Dictate mode
      }
    }

    function startStudyMode() {
      currentMode = 'study';
      landingPage.style.display = "none";
      flashcard.style.display = "none";
      dictationInput.style.display = "none";
      feedback.style.display = "none";
      nextBtn.style.display = "none";
      playBtn.style.display = "none";
      checkBtn.style.display = "none";
      backBtn.style.display = "none";
      score.style.display = "none";
      correctAnswers = 0;
      totalAttempts = 0;
      showCard();
    }

    function startDictateMode() {
      currentMode = 'dictate';
      landingPage.style.display = "none";
      flashcard.style.display = "none";
      dictationInput.style.display = "none";
      feedback.style.display = "none";
      nextBtn.style.display = "none";
      playBtn.style.display = "none";
      checkBtn.style.display = "none";
      backBtn.style.display = "none";
      score.style.display = "none";
      correctAnswers = 0;
      totalAttempts = 0;
      showCard();
    }

    function returnToLanding() {
      currentMode = null;
      currentIndex = 0;
      correctAnswers = 0;
      totalAttempts = 0;
      landingPage.style.display = "flex";
      flashcard.style.display = "none";
      dictationInput.style.display = "none";
      feedback.style.display = "none";
      nextBtn.style.display = "none";
      playBtn.style.display = "none";
      checkBtn.style.display = "none";
      backBtn.style.display = "none";
      score.style.display = "none";
    }

    function nextCard() {
      currentIndex = (currentIndex + 1) % words.length;
      showCard();
      cardSound.currentTime = 0;
      cardSound.play().catch(error => {
        console.log("Sound playback failed:", error);
      });
    }

    function playPronunciation() {
      const utterance = new SpeechSynthesisUtterance(words[currentIndex]);
      utterance.lang = 'en-GB';
      const voices = speechSynthesis.getVoices();
      const femaleVoice = voices.find(voice => voice.lang === 'en-GB' && voice.name.toLowerCase().includes('female')) || 
                         voices.find(voice => voice.lang === 'en-GB') || voices[0];
      utterance.voice = femaleVoice;
      speechSynthesis.speak(utterance);
      if (currentMode === 'dictate') {
        dictationInput.style.display = "block";
        dictationInput.focus();
      }
    }

    function checkAnswer() {
      if (currentMode !== 'dictate') return;
      const userInput = dictationInput.value.trim().toLowerCase();
      const correctAnswer = words[currentIndex].toLowerCase();
      totalAttempts++;
      flashcard.style.display = "flex";
      feedback.style.display = "block";
      if (userInput === correctAnswer) {
        correctAnswers++;
        feedback.textContent = "Correct! Well done!";
        feedback.style.backgroundColor = "rgba(38, 166, 154, 0.8)";
        clapSound.currentTime = 0;
        clapSound.play().catch(error => {
          console.log("Clap sound playback failed:", error);
        });
      } else {
        feedback.textContent = `Incorrect. The correct answer is: "${words[currentIndex]}"`;
        feedback.style.backgroundColor = "rgba(211, 47, 47, 0.8)";
      }
      score.textContent = `Score: ${correctAnswers}/${totalAttempts}`;
    }

    // Ensure voices are loaded
    window.speechSynthesis.onvoiceschanged = function() {};

    // Initialize landing page
    landingPage.style.display = "flex";
    flashcard.style.display = "none";
    dictationInput.style.display = "none";
    feedback.style.display = "none";
    nextBtn.style.display = "none";
    playBtn.style.display = "none";
    checkBtn.style.display = "none";
    backBtn.style.display = "none";
    score.style.display = "none";
  </script>
</body>
</html>
