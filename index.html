<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Dictation with Daddy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  body {margin:0;background:#B2EBF2;font-family:-apple-system,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;}
  #landing {text-align:center;}
  h1 {font-size:11vw;color:#004D40;margin-bottom:10vh;}
  .btn {padding:5vw 15vw;margin:5vh;font-size:9vw;border:none;border-radius:25px;color:white;cursor:pointer;}
  #study {background:#26A69A;}
  #dictate {background:#FF9800;}
  #game {display:none;text-align:center;padding:5vw;}
  #input {width:85vw;padding:5vw;font-size:8vw;border-radius:25px;border:none;text-align:center;margin:8vh 0;}
  #feedback {font-size:9vw;font-weight:bold;margin:8vh 0;}
  #buttons button {padding:3vw 8vw;margin:2vw;font-size:7vw;border:none;border-radius:20px;background:#004D40;color:white;cursor:pointer;}
</style>
</head>
<body>

<div id="landing">
  <h1>Dictation Time!</h1>
  <button class="btn" id="dictate">Dictate Mode</button>
</div>

<div id="game">
  <h2 style="margin:10vh 0 5vh;font-size:8vw;color:#004D40;">Type what Daddy says</h2>
  <input id="input" placeholder="Type here" autocomplete="off">
  <div id="feedback"></div>
  <div id="buttons">
    <button onclick="check()">Check</button>
    <button onclick="next()">Next</button>
    <button onclick="location.reload()">Back to Start</button>
  </div>
</div>

<audio id="clap" src="https://www.soundjay.com/human/applause-01.mp3"></audio>
<canvas id="confetti"></canvas>

<script>
  let correct = 0, total = 0;
  let lastAnswer = "";

  document.getElementById('dictate').onclick = () => {
    document.getElementById('landing').style.display = 'none';
    document.getElementById('game').style.display = 'block';
    document.getElementById('input').focus();
  };

  function check() {
    const typed = document.getElementById('input').value.trim();
    if (typed === "") return;

    total++;
    if (typed.toLowerCase() === lastAnswer.toLowerCase()) {
      correct++;
      document.getElementById('feedback').innerHTML = 'Correct! Well done!';
      document.getElementById('feedback').style.color = 'green';
      document.getElementById('clap').play();
    } else {
      document.getElementById('feedback').innerHTML = 'Wrong<br>The answer is: <b>' + lastAnswer + '</b>';
      document.getElementById('feedback').style.color = 'red';
    }
    if (correct === total && total > 0) setTimeout(confetti, 600);
  }

  function next() {
    lastAnswer = prompt("Daddy, type the CORRECT answer here (your son won't see this)", "");
    if (lastAnswer === null) lastAnswer = "";
    document.getElementById('input').value = "";
    document.getElementById('feedback').innerHTML = "";
    document.getElementById('input').focus();
  }

  function confetti() {
    const c = document.getElementById('confetti');
    c.style.display = 'block';
    c.width = innerWidth; c.height = innerHeight;
    const ctx = c.getContext('2d');
    const colors = ['#f00','#0f0','#00f','#ff0','#f0f'];
    let t = 0;
    const anim = setInterval(() => {
      ctx.clearRect(0,0,c.width,c.height);
      for(let i=0;i<300;i++){
        const x = (i*20 + t*3) % c.width;
        const y = (i*15 + t*2) % c.height;
        ctx.fillStyle = colors[i%5];
        ctx.fillRect(x, y, 15, 15);
      }
      t++;
    }, 30);
    setTimeout(() => {clearInterval(anim); c.style.display='none';}, 4000);
  }
</script>
</body>
</html>
