<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>P1 Dictation – Super Fun!</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  body {margin:0;background:linear-gradient(#B2EBF2,#81D4FA);font-family:-apple-system,sans-serif;height:100vh;overflow:hidden;display:flex;align-items:center;justify-content:center;}
  #landing h1 {font-size:11vw;color:#004D40;margin:8vh 0;}
  .btn {padding:6vw 18vw;margin:6vh;font-size:9vw;border:none;border-radius:30px;color:white;box-shadow:0 12px 35px rgba(0,0,0,0.4);cursor:pointer;}
  #studyBtn {background:#26A69A;}
  #dictateBtn {background:#FF9800;}

  #game {position:absolute;top:0;left:0;width:100%;height:100%;background:#B2EBF2;text-align:center;padding-top:8vh;display:none;}
  #score {position:fixed;top:7vh;background:rgba(0,77,64,0.95);color:white;padding:12px 35px;border-radius:30px;font-size:6.5vw;font-weight:bold;}
  #card {background:#009688;color:white;width:88vw;height:48vh;margin:8vh auto 4vh;border-radius:45px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:11vw;font-weight:bold;box-shadow:0 25px 60px rgba(0,0,0,0.4);}
  #card.sentence {font-size:7.5vw;}
  #listen {font-size:20vw;margin:10vh 0;animation:bounce 1.5s infinite;}
  @keyframes bounce {0%,100%{transform:translateY(0)} 50%{transform:translateY(-20px)}}
  #input {width:88vw;padding:5vw;font-size:8vw;border-radius:30px;border:none;text-align:center;margin:4vh 0;box-shadow:inset 0 6px 20px rgba(0,0,0,0.2);}
  #bottom {position:fixed;bottom:6vh;left:50%;transform:translateX(-50%);background:rgba(0,77,64,0.98);border-radius:45px;padding:3vh 7vw;display:flex;gap:10vw;box-shadow:0 20px 50px rgba(0,0,0,0.5);}
  #bottom button {background:transparent;color:white;border:none;font-size:7.5vw;font-weight:bold;cursor:pointer;}
  canvas {position:fixed;top:0;left:0;pointer-events:none;z-index:999;}
</style>
</head>
<body>

<div id="landing" style="text-align:center">
  <h1>P1 Dictation Fun!</h1>
  <button class="btn" id="studyBtn">Study Mode</button>
  <button class="btn" id="dictateBtn">Dictation Game</button>
</div>

<div id="game">
  <div id="score">0 / 0</div>
  <div id="card">
    <div id="listen">Ready?</div>
  </div>
  <input id="input" placeholder="Type here" autocomplete="off">
  <div id="bottom">
    <button onclick="play()">Play</button>
    <button onclick="check()">Check</button>
    <button onclick="next()">Next</button>
    <button onclick="location.reload()">Menu</button>
  </div>
</div>

<canvas id="confetti"></canvas>
<audio id="clap" src="https://www.soundjay.com/human/applause-01.mp3"></audio>
<audio id="win" src="https://www.soundjay.com/misc/success-1.mp3"></audio>

<script>
// ←←← ONLY CHANGE THIS LIST EVERY WEEK
const words = [
  "o","s","m","h",
  "one","four","nine","they","what","has","have","and","play","our",
  "This is a desk.","This is a bookshelf.","This is a computer.",
  "She has two sharpeners.","Tom has three rulers and six erasers.",
  "We have three pens.","They have five school bags."
];

let i = 0, correct = 0, total = 0, streak = 0, mode = "";

document.getElementById('studyBtn').onclick = () => start('study');
document.getElementById('dictateBtn').onclick = () => start('dictate');

function start(m) {
  mode = m; i = correct = total = streak = 0;
  document.getElementById('landing').style.display = 'none';
  document.getElementById('game').style.display = 'block';
  document.getElementById('score').textContent = '0 / 0';
  next();
}

function play() {
  const utter = new SpeechSynthesisUtterance(words[i]);
  utter.lang = 'en-GB';
  speechSynthesis.cancel();
  speechSynthesis.speak(utter);

  if (mode === 'dictate') {
    document.getElementById('card').innerHTML = '<div id="listen">Listening…</div>';
    document.getElementById('card').style.background = '#004D40';
  }
  document.getElementById('input').focus();
}

function check() {
  if (!document.getElementById('input').value.trim()) return;
  total++;
  const typed = document.getElementById('input').value.trim();
  const card = document.getElementById('card');

  if (typed.toLowerCase() === words[i].toLowerCase()) {
    correct++; streak++;
    card.innerHTML = 'Correct!<br>Great job!';
    card.style.background = '#2E7D32';
    document.getElementById('clap').play();
    if (streak % 5 === 0) starRain();
  } else {
    streak = 0;
    card.innerHTML = 'Oops!<br>The answer is:<br><b>' + words[i] + '</b>';
    card.style.background = '#C62828';
  }
  document.getElementById('score').textContent = correct + ' / ' + total;
  if (correct === words.length) setTimeout(victory, 1000);
}

function next() {
  i = (i + 1) % words.length;
  document.getElementById('input').value = '';
  const card = document.getElementById('card');
  if (mode === 'study') {
    card.textContent = words[i];
    card.style.background = '#009688';
  } else {
    card.innerHTML = '<div id="listen">Ready?</div>';
    card.style.background = '#009688';
  }
}

function starRain() {
  for(let k=0;k<30;k++) {
    setTimeout(() => confettiBurst('#FFD700'), k*100);
  }
}

function victory() {
  document.getElementById('win').play();
  confettiBurst('#FF0000'); confettiBurst('#00FF00'); confettiBurst('#0000FF');
  setTimeout(() => confettiBurst('#FFFF00'), 500);
  setTimeout(() => confettiBurst('#FF00FF'), 1000);
}

function confettiBurst(color = null) {
  const c = document.getElementById('confetti'); c.style.display='block';
  c.width = innerWidth; c.height = innerHeight;
  const ctx = c.getContext('2d');
  const p = [];
  const cols = color ? [color] : ['#f00','#ff0','#0f0','#0ff','#f0f'];
  for(let j=0;j<300;j++) p.push({x:innerWidth/2,y:innerHeight/2,c:cols[j%cols.length],s:Math.random()*12+8,a:Math.random()*Math.PI*2,v:Math.random()*12+8});
  let t=0;
  const anim = setInterval(()=>{
    ctx.clearRect(0,0,c.width,c.height);
    p.forEach(o=>{o.x+=Math.cos(o.a)*o.v; o.y+=Math.sin(o.a)*o.v+o.s/10; if(o.y>c.height||o.x<0||o.x>c.width) o.y=-50;
      ctx.fillStyle=o.c; ctx.fillRect(o.x,o.y,16,16);});
    t++; if(t>80) {clearInterval(anim); c.style.display='none';}
  },20);
}
</script>
</body>
</html>
